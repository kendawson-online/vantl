{"version":3,"file":"timeline.min.js","sources":["../src/js/shared/state.js","../src/js/features/modals.js","../src/js/features/deep-linking.js","../src/js/shared/config.js","../src/js/features/loader-ui.js","../src/js/features/error-ui.js","../src/js/shared/utils.js","../src/js/features/colors.js","../src/js/core/timeline-engine.js","../src/js/features/data-loader.js","../src/js/timeline.js"],"sourcesContent":["// Shared state containers\nexport const loaderState = {\n  count: 0,\n  startTime: 0,\n  removeTimer: null,\n  overlayEl: null\n};\n\nexport const modalState = {\n  modal: null,\n  overlay: null\n};\n\n// Global registry to store timeline instances for programmatic navigation\nexport const timelineRegistry = {};\n","import { modalState } from '../shared/state.js';\n\nexport function createTimelineModal() {\n  if (modalState.modal) return;\n\n  modalState.overlay = document.createElement('div');\n  modalState.overlay.className = 'timeline-modal-overlay';\n  modalState.overlay.addEventListener('click', closeTimelineModal);\n\n  modalState.modal = document.createElement('div');\n  modalState.modal.className = 'timeline-modal';\n  modalState.modal.innerHTML = `\n    <button class=\"timeline-modal__close\" aria-label=\"Close modal\"></button>\n    <div class=\"timeline-modal__content\">\n      <img class=\"timeline-modal__image\" src=\"\" alt=\"\" style=\"display: none;\">\n      <h2 class=\"timeline-modal__title\"></h2>\n      <div class=\"timeline-modal__text\"></div>\n      <hr class=\"timeline-modal__divider\">\n      <button class=\"timeline-modal__close-bottom\">Close</button>\n    </div>\n  `;\n\n  const closeBtn = modalState.modal.querySelector('.timeline-modal__close');\n  const closeBottomBtn = modalState.modal.querySelector('.timeline-modal__close-bottom');\n  closeBtn.addEventListener('click', closeTimelineModal);\n  closeBottomBtn.addEventListener('click', closeTimelineModal);\n\n  modalState.modal.addEventListener('click', function(e) {\n    e.stopPropagation();\n  });\n\n  document.body.appendChild(modalState.overlay);\n  document.body.appendChild(modalState.modal);\n\n  document.addEventListener('keydown', function(e) {\n    if (e.key === 'Escape' && modalState.modal.classList.contains('timeline-modal-show')) {\n      closeTimelineModal();\n    }\n  });\n}\n\nexport function openTimelineModal(itemEl) {\n  if (!modalState.modal) {\n    createTimelineModal();\n  }\n\n  const title = itemEl.getAttribute('data-modal-title');\n  const content = itemEl.getAttribute('data-modal-content');\n  const image = itemEl.getAttribute('data-modal-image');\n  const html = itemEl.getAttribute('data-modal-html');\n\n  const modalTitle = modalState.modal.querySelector('.timeline-modal__title');\n  const modalText = modalState.modal.querySelector('.timeline-modal__text');\n  const modalImage = modalState.modal.querySelector('.timeline-modal__image');\n\n  modalTitle.textContent = title || '';\n\n  if (image) {\n    modalImage.src = image;\n    modalImage.alt = title || '';\n    modalImage.style.display = 'block';\n  } else {\n    modalImage.style.display = 'none';\n  }\n\n  if (html) {\n    modalText.innerHTML = html;\n  } else if (content) {\n    modalText.innerHTML = '<p>' + content.replace(/\\n/g, '</p><p>') + '</p>';\n  } else {\n    modalText.innerHTML = '';\n  }\n\n  setTimeout(function() {\n    modalState.modal.classList.add('timeline-modal-show');\n    modalState.overlay.classList.add('timeline-modal-show');\n    document.body.style.overflow = 'hidden';\n  }, 10);\n}\n\nexport function closeTimelineModal() {\n  if (modalState.modal) {\n    modalState.modal.classList.remove('timeline-modal-show');\n    modalState.overlay.classList.remove('timeline-modal-show');\n    document.body.style.overflow = '';\n  }\n}\n","import { timelineRegistry } from '../shared/state.js';\n\nexport function handleDeepLinking(containerSelector) {\n  const urlParams = new URLSearchParams(window.location.search);\n  const timelineId = urlParams.get('timeline');\n  const nodeId = urlParams.get('id');\n  if (!nodeId) return;\n\n  let targetContainer;\n  if (timelineId) {\n    targetContainer = document.getElementById(timelineId);\n  } else {\n    targetContainer = document.querySelector(containerSelector);\n  }\n\n  if (!targetContainer) {\n    console.warn('Timeline not found for deep linking:', timelineId || containerSelector);\n    return;\n  }\n\n  targetContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });\n\n  const targetNode = targetContainer.querySelector('[data-node-id=\"' + nodeId + '\"]');\n  if (targetNode) {\n    setTimeout(function() {\n      targetNode.classList.add('timeline__item--active');\n      const itemIndex = Array.from(targetNode.parentNode.children).indexOf(targetNode);\n      navigateToNodeIndex(targetContainer, itemIndex);\n    }, 500);\n  }\n}\n\nexport function navigateToNodeIndex(container, index) {\n  if (!container) return;\n  const timelineId = container.id || container.getAttribute('data-timeline-id');\n  if (!timelineId) {\n    console.warn('Cannot navigate: timeline container has no ID');\n    return;\n  }\n\n  const tlData = timelineRegistry[timelineId];\n  if (!tlData) {\n    console.warn('Timeline not found in registry:', timelineId);\n    return;\n  }\n\n  if (!container.classList.contains('timeline--horizontal')) {\n    return;\n  }\n\n  if (tlData.setCurrentIndex && tlData.updatePosition) {\n    tlData.setCurrentIndex(index);\n    tlData.updatePosition();\n  }\n}\n","// Shared configuration values\n// Auto-detect the timeline.js script location to build correct image paths\nexport const timelineBasePath = (function() {\n  // Check for user override\n  if (typeof window !== 'undefined' && \n      window.TimelineConfig && \n      window.TimelineConfig.basePath) {\n    return window.TimelineConfig.basePath;\n  }\n  \n  const scripts = document.getElementsByTagName('script');\n  for (let i = 0; i < scripts.length; i++) {\n    const src = scripts[i].src || '';\n    if (!src) continue;\n    const dir = src.substring(0, src.lastIndexOf('/'));\n    if (src.indexOf('timeline.min.js') !== -1) {\n      // When loading from dist, map to src/images\n      return dir.replace('/dist', '/src/images');\n    }\n    if (src.indexOf('timeline.js') !== -1) {\n      // When loading from src/js, map to src/images\n      return dir.replace('/js', '/images');\n    }\n  }\n  // Fallback relative to demo pages; most demos live under demo/**\n  return '../src/images';\n})();\n\n// Minimum time (ms) to keep the loading spinner visible\nlet timelineLoaderMinMs = 1300;\nexport function getTimelineLoaderMinMs() {\n  return timelineLoaderMinMs;\n}\nexport function setTimelineLoaderMinMs(value) {\n  if (typeof value === 'number' && value >= 0) {\n    timelineLoaderMinMs = value;\n  }\n}\n","import { loaderState } from '../shared/state.js';\nimport { getTimelineLoaderMinMs, timelineBasePath } from '../shared/config.js';\n\nexport function showTimelineLoader() {\n  loaderState.count += 1;\n  if (loaderState.count !== 1) return;\n\n  loaderState.startTime = Date.now();\n\n  if (loaderState.removeTimer) {\n    clearTimeout(loaderState.removeTimer);\n    loaderState.removeTimer = null;\n  }\n\n  const overlay = document.createElement('div');\n  overlay.className = 'timeline__loader-overlay';\n\n  const loader = document.createElement('div');\n  loader.className = 'timeline__loader';\n\n  const spinner = document.createElement('img');\n  spinner.src = timelineBasePath + '/spinner.gif';\n  spinner.alt = 'Loading...';\n  spinner.title = 'Loading...';\n  spinner.className = 'timeline__loader-spinner';\n  // Default to a compact spinner if page CSS is missing\n  spinner.width = 120;\n  spinner.style.height = 'auto';\n\n  loader.appendChild(spinner);\n  overlay.appendChild(loader);\n\n  document.body.appendChild(overlay);\n  loaderState.overlayEl = overlay;\n}\n\nexport function hideTimelineLoader() {\n  if (loaderState.count <= 0) return;\n  loaderState.count -= 1;\n  if (loaderState.count > 0) return;\n\n  const elapsed = Date.now() - loaderState.startTime;\n  const minMs = getTimelineLoaderMinMs();\n  const remaining = Math.max(0, minMs - elapsed);\n\n  const removeOverlay = function() {\n    if (loaderState.overlayEl) {\n      loaderState.overlayEl.remove();\n      loaderState.overlayEl = null;\n    }\n    loaderState.removeTimer = null;\n  };\n\n  if (loaderState.removeTimer) {\n    clearTimeout(loaderState.removeTimer);\n    loaderState.removeTimer = null;\n  }\n\n  if (remaining > 0) {\n    loaderState.removeTimer = setTimeout(removeOverlay, remaining);\n  } else {\n    removeOverlay();\n  }\n}\n","import { timelineBasePath } from '../shared/config.js';\nimport { hideTimelineLoader } from './loader-ui.js';\n\nexport function showTimelineError(container, errorType, details) {\n  if (!container) return;\n\n  const errorMessages = {\n    'json-load': {\n      title: 'Timeline Data Could Not Be Loaded',\n      message: 'The timeline data failed to load. This could be due to a network error or an incorrect file path.',\n      solution: 'Please check that the data-json-config path is correct and the file is accessible.'\n    },\n    'json-parse': {\n      title: 'Invalid Timeline Data',\n      message: 'The timeline data file exists but contains invalid JSON.',\n      solution: 'Please validate your JSON using a tool like jsonlint.com and ensure it follows the correct schema.'\n    },\n    'missing-element': {\n      title: 'Timeline Element Not Found',\n      message: 'The required timeline container element could not be found on the page.',\n      solution: 'Ensure your HTML includes a container with the class \"timeline\" and the correct selector.'\n    },\n    'invalid-config': {\n      title: 'Invalid Configuration',\n      message: 'One or more timeline configuration options are invalid.',\n      solution: 'Check your data attributes or JavaScript options and ensure they match the expected format.'\n    }\n  };\n\n  const errorInfo = errorMessages[errorType] || {\n    title: 'Timeline Error',\n    message: 'An unexpected error occurred while initializing the timeline.',\n    solution: 'Please check the browser console for more details.'\n  };\n\n  hideTimelineLoader(container);\n  container.innerHTML = '';\n\n  const errorDiv = document.createElement('div');\n  errorDiv.className = 'timeline__error';\n\n  const errorIcon = document.createElement('img');\n  errorIcon.src = timelineBasePath + '/alert.svg';\n  errorIcon.alt = 'Error';\n  errorIcon.className = 'timeline__error-icon';\n  // Ensure a reasonable default size even if CSS isn't loaded\n  // This makes the error icon usable when a consumer forgets to include CSS.\n  errorIcon.width = 200;\n  errorIcon.style.height = 'auto';\n\n  const errorTitle = document.createElement('h2');\n  errorTitle.className = 'timeline__error-title';\n  errorTitle.textContent = errorInfo.title;\n\n  const errorMessage = document.createElement('p');\n  errorMessage.className = 'timeline__error-message';\n  errorMessage.textContent = errorInfo.message;\n\n  const errorSolution = document.createElement('p');\n  errorSolution.className = 'timeline__error-solution';\n  errorSolution.innerHTML = '<strong>Solution:</strong> ' + errorInfo.solution;\n\n  if (details) {\n    const errorDetails = document.createElement('p');\n    errorDetails.className = 'timeline__error-details';\n    errorDetails.innerHTML = '<strong>Details:</strong> ' + details;\n    errorDiv.appendChild(errorDetails);\n  }\n\n  errorDiv.appendChild(errorIcon);\n  errorDiv.appendChild(errorTitle);\n  errorDiv.appendChild(errorMessage);\n  errorDiv.appendChild(errorSolution);\n\n  container.appendChild(errorDiv);\n\n  console.error('Timeline Error [' + errorType + ']:', errorInfo.message, details || '');\n}\n","// Utility helpers shared across modules\nexport function getContrastColor(bgColor) {\n  const brightness = getColorBrightness(bgColor);\n  return brightness > 128 ? 'rgba(0, 0, 0, 0.2)' : 'rgba(255, 255, 255, 0.3)';\n}\n\nexport function getColorBrightness(color) {\n  let rgb;\n  if (!color || typeof color !== 'string') return 128;\n\n  if (color.startsWith('#')) {\n    let hex = color.substring(1);\n    if (hex.length === 3) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    const r = parseInt(hex.substring(0, 2), 16);\n    const g = parseInt(hex.substring(2, 4), 16);\n    const b = parseInt(hex.substring(4, 6), 16);\n    rgb = [r, g, b];\n  } else if (color.startsWith('rgb')) {\n    const matches = color.match(/\\d+/g);\n    rgb = matches ? matches.map(Number) : [128, 128, 128];\n  } else {\n    return 128;\n  }\n\n  return (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;\n}\n","import { getContrastColor, getColorBrightness } from '../shared/utils.js';\n\nexport function applyTimelineColors(container, config) {\n  let nodeColor = config.nodeColor || null;\n  let lineColor = config.lineColor || null;\n  const navColor = config.navColor || null;\n\n  if (nodeColor && !lineColor) lineColor = nodeColor;\n  if (lineColor && !nodeColor) nodeColor = lineColor;\n\n  if (nodeColor) {\n    container.style.setProperty('--timeline-node-color', nodeColor);\n  }\n  if (lineColor) {\n    container.style.setProperty('--timeline-line-color', lineColor);\n  }\n  if (navColor) {\n    container.style.setProperty('--timeline-nav-color', navColor);\n    container.style.setProperty('--timeline-nav-border', getContrastColor(navColor));\n    const brightness = getColorBrightness(navColor);\n    const arrowColor = brightness > 128 ? '#333' : '#fff';\n    container.style.setProperty('--timeline-arrow-color', arrowColor);\n    container.setAttribute('data-arrow-color', arrowColor);\n  }\n}\n","import { showTimelineLoader, hideTimelineLoader } from '../features/loader-ui.js';\nimport { showTimelineError } from '../features/error-ui.js';\nimport { applyTimelineColors } from '../features/colors.js';\nimport { openTimelineModal } from '../features/modals.js';\nimport { timelineRegistry } from '../shared/state.js';\n\nfunction ensureInlineModalData(itemEl) {\n  if (!itemEl) return;\n  const content = itemEl.querySelector('.timeline__content') || itemEl;\n  if (!itemEl.hasAttribute('data-modal-title')) {\n    const heading = content.querySelector('h1,h2,h3,h4,h5,h6');\n    if (heading && heading.textContent) {\n      itemEl.setAttribute('data-modal-title', heading.textContent.trim());\n    }\n  }\n  if (!itemEl.hasAttribute('data-modal-content')) {\n    const firstP = content.querySelector('p');\n    if (firstP && firstP.textContent) {\n      itemEl.setAttribute('data-modal-content', firstP.textContent.trim());\n    }\n  }\n  if (!itemEl.hasAttribute('data-modal-image')) {\n    const img = content.querySelector('img');\n    if (img && img.getAttribute('src')) {\n      itemEl.setAttribute('data-modal-image', img.getAttribute('src'));\n    }\n  }\n}\n\nfunction enhanceInlineItems(timelineEl, items) {\n  if (!items || !items.length) return;\n  items.forEach(function(item){\n    if (item.getAttribute('data-modal-bound') === '1') return;\n    ensureInlineModalData(item);\n    const hasModal = item.hasAttribute('data-modal-title') || item.hasAttribute('data-modal-content') || item.hasAttribute('data-modal-image') || item.hasAttribute('data-modal-html');\n    if (hasModal) {\n      item.addEventListener('click', function(e){\n        e.preventDefault();\n        openTimelineModal(item);\n      });\n      item.setAttribute('data-modal-bound', '1');\n    }\n  });\n}\n\nfunction createArrowSVG(direction, color) {\n  if (direction === 'left') {\n    return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"7.8\" height=\"14\" style=\"display:block;margin:auto;\"><path fill=\"none\" stroke=\"' + color + '\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6.8 1L1 7l5.8 6\"/></svg>';\n  }\n  return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"7.8\" height=\"14\" style=\"display:block;margin:auto;\"><path fill=\"none\" stroke=\"' + color + '\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M1 1l5.8 6L1 13\"/></svg>';\n}\n\nexport function timeline(collection, options) {\n  const timelines = [];\n  const warningLabel = 'Timeline:';\n  let winWidth = window.innerWidth;\n  let resizeTimer;\n  let currentIndex = 0;\n  const eventListeners = new Map(); // Track listeners for cleanup\n\n  showTimelineLoader();\n  let shouldHideLoader = true;\n\n  const defaultSettings = {\n    minWidth: { type: 'integer', defaultValue: 600 },\n    maxWidth: { type: 'integer', defaultValue: 600 },\n    horizontalStartPosition: { type: 'string', acceptedValues: ['bottom', 'top'], defaultValue: 'top' },\n    mode: { type: 'string', acceptedValues: ['horizontal', 'vertical'], defaultValue: 'vertical' },\n    moveItems: { type: 'integer', defaultValue: 1 },\n    rtlMode: { type: 'boolean', acceptedValues: [true, false], defaultValue: false },\n    startIndex: { type: 'integer', defaultValue: 0 },\n    verticalStartPosition: { type: 'string', acceptedValues: ['left', 'right'], defaultValue: 'left' },\n    verticalTrigger: { type: 'string', defaultValue: '15%' },\n    visibleItems: { type: 'integer', defaultValue: 3 }\n  };\n\n  function testValues(value, settingName) {\n    if (typeof value !== 'number' && value % 1 !== 0) {\n      console.warn(`${warningLabel} The value \"${value}\" entered for the setting \"${settingName}\" is not an integer.`);\n      return false;\n    }\n    return true;\n  }\n\n  function itemWrap(el, wrapper, classes) {\n    wrapper.classList.add(classes);\n    el.parentNode.insertBefore(wrapper, el);\n    wrapper.appendChild(el);\n  }\n\n  function wrapElements(items) {\n    items.forEach((item) => {\n      itemWrap(item.querySelector('.timeline__content'), document.createElement('div'), 'timeline__content__wrap');\n      itemWrap(item.querySelector('.timeline__content__wrap'), document.createElement('div'), 'timeline__item__inner');\n    });\n  }\n\n  function isElementInViewport(el, triggerPosition) {\n    const rect = el.getBoundingClientRect();\n    const windowHeight = window.innerHeight || document.documentElement.clientHeight;\n    const defaultTrigger = defaultSettings.verticalTrigger.defaultValue.match(/(\\d*\\.?\\d*)(.*)/);\n    let triggerUnit = triggerPosition.unit;\n    let triggerValue = triggerPosition.value;\n    let trigger = windowHeight;\n    if (triggerUnit === 'px' && triggerValue >= windowHeight) {\n      console.warn('The value entered for the setting \"verticalTrigger\" is larger than the window height. The default value will be used instead.');\n      [, triggerValue, triggerUnit] = defaultTrigger;\n    }\n    if (triggerUnit === 'px') {\n      trigger = parseInt(trigger - triggerValue, 10);\n    } else if (triggerUnit === '%') {\n      trigger = parseInt(trigger * ((100 - triggerValue) / 100), 10);\n    }\n    return (\n      rect.top <= trigger &&\n      rect.left <= (window.innerWidth || document.documentElement.clientWidth) &&\n      (rect.top + rect.height) >= 0 &&\n      (rect.left + rect.width) >= 0\n    );\n  }\n\n  function addTransforms(el, transform) {\n    el.style.webkitTransform = transform;\n    el.style.msTransform = transform;\n    el.style.transform = transform;\n  }\n\n  function createTimelines(timelineEl) {\n    const timelineName = timelineEl.id ? `#${timelineEl.id}` : `.${timelineEl.className}`;\n    const errorPart = 'could not be found as a direct descendant of';\n    const data = timelineEl.dataset;\n    let wrap;\n    let scroller;\n    let items;\n    const settings = {};\n\n    try {\n      wrap = timelineEl.querySelector('.timeline__wrap');\n      if (!wrap) {\n        throw new Error(`${warningLabel} .timeline__wrap ${errorPart} ${timelineName}`);\n      } else {\n        scroller = wrap.querySelector('.timeline__items');\n        if (!scroller) {\n          throw new Error(`${warningLabel} .timeline__items ${errorPart} .timeline__wrap`);\n        } else {\n          items = [].slice.call(scroller.children, 0);\n        }\n      }\n    } catch (e) {\n      console.warn(e.message);\n      showTimelineError(timelineEl, 'missing-element', e.message);\n      return false;\n    }\n\n    Object.keys(defaultSettings).forEach((key) => {\n      settings[key] = defaultSettings[key].defaultValue;\n\n      if (key === 'minWidth') {\n        let candidate = undefined;\n        if (data.minWidth !== undefined) candidate = data.minWidth;\n        if (data.minwidth !== undefined) candidate = data.minwidth;\n        if (data.forceVerticalMode !== undefined) candidate = data.forceVerticalMode;\n        if (data.forceverticalmode !== undefined) candidate = data.forceverticalmode;\n        if (candidate === undefined && options) {\n          if (options.minWidth !== undefined) candidate = options.minWidth;\n          else if (options.forceVerticalMode !== undefined) candidate = options.forceVerticalMode;\n        }\n        if (candidate !== undefined) settings.minWidth = candidate;\n      } else if (key === 'maxWidth') {\n        let candidate = undefined;\n        if (data.maxWidth !== undefined) candidate = data.maxWidth;\n        if (data.maxwidth !== undefined) candidate = data.maxwidth;\n        if (candidate === undefined && options) {\n          if (options.maxWidth !== undefined) candidate = options.maxWidth;\n        }\n        if (candidate !== undefined) settings.maxWidth = candidate;\n      } else {\n        if (data[key]) {\n          settings[key] = data[key];\n        } else if (options && options[key] !== undefined) {\n          settings[key] = options[key];\n        }\n      }\n\n      if (defaultSettings[key].type === 'integer') {\n        if (!settings[key] || !testValues(settings[key], key)) {\n          settings[key] = defaultSettings[key].defaultValue;\n        }\n      } else if (defaultSettings[key].type === 'string') {\n        if (defaultSettings[key].acceptedValues && defaultSettings[key].acceptedValues.indexOf(settings[key]) === -1) {\n          console.warn(`${warningLabel} The value \"${settings[key]}\" entered for the setting \"${key}\" was not recognised.`);\n          settings[key] = defaultSettings[key].defaultValue;\n        }\n      }\n    });\n\n    (function applyColorParity(){\n      const data = timelineEl.dataset;\n      const getData = function(k){\n        return data[k] !== undefined ? data[k] : (data[k && k.toLowerCase()] !== undefined ? data[k.toLowerCase()] : undefined);\n      };\n      let nodeColor = getData('nodeColor');\n      let lineColor = getData('lineColor');\n      let navColor = getData('navColor');\n      if (options) {\n        if (options.nodeColor !== undefined) nodeColor = options.nodeColor;\n        if (options.lineColor !== undefined) lineColor = options.lineColor;\n        if (options.navColor !== undefined) navColor = options.navColor;\n      }\n      if (nodeColor || lineColor || navColor) {\n        applyTimelineColors(timelineEl, { nodeColor, lineColor, navColor });\n      }\n    })();\n\n    const defaultTrigger = defaultSettings.verticalTrigger.defaultValue.match(/(\\d*\\.?\\d*)(.*)/);\n    const triggerArray = settings.verticalTrigger.match(/(\\d*\\.?\\d*)(.*)/);\n    let [, triggerValue, triggerUnit] = triggerArray;\n    let triggerValid = true;\n    if (!triggerValue) {\n      console.warn(`${warningLabel} No numercial value entered for the 'verticalTrigger' setting.`);\n      triggerValid = false;\n    }\n    if (triggerUnit !== 'px' && triggerUnit !== '%') {\n      console.warn(`${warningLabel} The setting 'verticalTrigger' must be a percentage or pixel value.`);\n      triggerValid = false;\n    }\n    if (triggerUnit === '%' && (triggerValue > 100 || triggerValue < 0)) {\n      console.warn(`${warningLabel} The 'verticalTrigger' setting value must be between 0 and 100 if using a percentage value.`);\n      triggerValid = false;\n    } else if (triggerUnit === 'px' && triggerValue < 0) {\n      console.warn(`${warningLabel} The 'verticalTrigger' setting value must be above 0 if using a pixel value.`);\n      triggerValid = false;\n    }\n\n    if (triggerValid === false) {\n      [, triggerValue, triggerUnit] = defaultTrigger;\n    }\n\n    settings.verticalTrigger = {\n      unit: triggerUnit,\n      value: triggerValue\n    };\n\n    if (settings.moveItems > settings.visibleItems) {\n      console.warn(`${warningLabel} The value of \"moveItems\" (${settings.moveItems}) is larger than the number of \"visibleItems\" (${settings.visibleItems}). The value of \"visibleItems\" has been used instead.`);\n      settings.moveItems = settings.visibleItems;\n    }\n\n    if (settings.startIndex > (items.length - settings.visibleItems) && items.length > settings.visibleItems) {\n      console.warn(`${warningLabel} The 'startIndex' setting must be between 0 and ${items.length - settings.visibleItems} for this timeline. The value of ${items.length - settings.visibleItems} has been used instead.`);\n      settings.startIndex = items.length - settings.visibleItems;\n    } else if (items.length <= settings.visibleItems) {\n      console.warn(`${warningLabel} The number of items in the timeline must exceed the number of visible items to use the 'startIndex' option.`);\n      settings.startIndex = 0;\n    } else if (settings.startIndex < 0) {\n      console.warn(`${warningLabel} The 'startIndex' setting must be between 0 and ${items.length - settings.visibleItems} for this timeline. The value of 0 has been used instead.`);\n      settings.startIndex = 0;\n    }\n\n    enhanceInlineItems(timelineEl, items);\n\n    if (!timelineEl.id) {\n      timelineEl.setAttribute('data-timeline-id', 'timeline-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9));\n    }\n\n    timelines.push({\n      timelineEl,\n      wrap,\n      scroller,\n      items,\n      settings,\n      listeners: [] // Store listeners for cleanup\n    });\n  }\n\n  if (collection.length) {\n    Array.from(collection).forEach(createTimelines);\n  }\n\n  function setHeightandWidths(tl) {\n    function setWidths() {\n      tl.itemWidth = 200;\n      tl.items.forEach((item) => {\n        item.style.width = `${tl.itemWidth}px`;\n      });\n      tl.scrollerWidth = tl.itemWidth * tl.items.length;\n      tl.scroller.style.width = `${tl.scrollerWidth}px`;\n    }\n\n    function setHeights() {\n      let oddIndexTallest = 0;\n      let evenIndexTallest = 0;\n      tl.items.forEach((item, i) => {\n        item.style.height = 'auto';\n        const height = item.offsetHeight;\n        if (i % 2 === 0) {\n          evenIndexTallest = height > evenIndexTallest ? height : evenIndexTallest;\n        } else {\n          oddIndexTallest = height > oddIndexTallest ? height : oddIndexTallest;\n        }\n      });\n\n      const transformString = `translateY(${evenIndexTallest}px)`;\n      tl.items.forEach((item, i) => {\n        if (i % 2 === 0) {\n          item.style.height = `${evenIndexTallest}px`;\n          if (tl.settings.horizontalStartPosition === 'bottom') {\n            item.classList.add('timeline__item--bottom');\n            addTransforms(item, transformString);\n          } else {\n            item.classList.add('timeline__item--top');\n          }\n        } else {\n          item.style.height = `${oddIndexTallest}px`;\n          if (tl.settings.horizontalStartPosition !== 'bottom') {\n            item.classList.add('timeline__item--bottom');\n            addTransforms(item, transformString);\n          } else {\n            item.classList.add('timeline__item--top');\n          }\n        }\n      });\n      tl.scroller.style.height = `${evenIndexTallest + oddIndexTallest}px`;\n    }\n\n    if (window.innerWidth > tl.settings.minWidth) {\n      setWidths();\n      setHeights();\n    }\n  }\n\n  function addNavigation(tl) {\n    const viewportWidth = tl.wrap.offsetWidth;\n    const itemsVisible = Math.floor(viewportWidth / tl.itemWidth);\n\n    if (tl.items.length > itemsVisible) {\n      const prevArrow = document.createElement('button');\n      const nextArrow = document.createElement('button');\n      const topPosition = tl.items[0].offsetHeight;\n      prevArrow.className = 'timeline-nav-button timeline-nav-button--prev';\n      nextArrow.className = 'timeline-nav-button timeline-nav-button--next';\n      prevArrow.textContent = 'Previous';\n      nextArrow.textContent = 'Next';\n      prevArrow.style.top = `${topPosition}px`;\n      nextArrow.style.top = `${topPosition}px`;\n\n      const arrowColor = tl.timelineEl.getAttribute('data-arrow-color') || '#333';\n      prevArrow.innerHTML = createArrowSVG('left', arrowColor);\n      nextArrow.innerHTML = createArrowSVG('right', arrowColor);\n\n      const maxIndex = Math.max(0, tl.items.length - itemsVisible);\n      if (currentIndex === 0) {\n        prevArrow.disabled = true;\n      } else if (currentIndex >= maxIndex) {\n        nextArrow.disabled = true;\n      }\n      tl.timelineEl.appendChild(prevArrow);\n      tl.timelineEl.appendChild(nextArrow);\n    }\n  }\n\n  function addHorizontalDivider(tl) {\n    const divider = tl.timelineEl.querySelector('.timeline-divider');\n    if (divider) {\n      tl.timelineEl.removeChild(divider);\n    }\n    const topPosition = tl.items[0].offsetHeight;\n    const horizontalDivider = document.createElement('span');\n    horizontalDivider.className = 'timeline-divider';\n    horizontalDivider.style.top = `${topPosition}px`;\n    tl.timelineEl.appendChild(horizontalDivider);\n  }\n\n  function timelinePosition(tl) {\n    const position = tl.items[currentIndex].offsetLeft;\n    const str = `translate3d(-${position}px, 0, 0)`;\n    addTransforms(tl.scroller, str);\n  }\n\n  function slideTimeline(tl) {\n    const navArrows = tl.timelineEl.querySelectorAll('.timeline-nav-button');\n    const arrowPrev = tl.timelineEl.querySelector('.timeline-nav-button--prev');\n    const arrowNext = tl.timelineEl.querySelector('.timeline-nav-button--next');\n\n    const viewportWidth = tl.wrap.offsetWidth;\n    const itemsVisible = Math.floor(viewportWidth / tl.itemWidth);\n    const maxIndex = Math.max(0, tl.items.length - itemsVisible);\n\n    const moveItems = parseInt(tl.settings.moveItems, 10);\n    \n    const handleArrowClick = function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (this.disabled) {\n        return;\n      }\n\n      currentIndex = this.classList.contains('timeline-nav-button--next') ? (currentIndex += moveItems) : (currentIndex -= moveItems);\n      if (currentIndex === 0 || currentIndex < 0) {\n        currentIndex = 0;\n        arrowPrev.disabled = true;\n        arrowNext.disabled = false;\n      } else if (currentIndex === maxIndex || currentIndex > maxIndex) {\n        currentIndex = maxIndex;\n        arrowPrev.disabled = false;\n        arrowNext.disabled = true;\n      } else {\n        arrowPrev.disabled = false;\n        arrowNext.disabled = false;\n      }\n      timelinePosition(tl);\n    };\n    \n    Array.from(navArrows).forEach((arrow) => {\n      arrow.addEventListener('click', handleArrowClick);\n      tl.listeners.push({ element: arrow, type: 'click', handler: handleArrowClick });\n    });\n  }\n\n  function setUpHorinzontalTimeline(tl) {\n    if (tl.settings.rtlMode) {\n      currentIndex = tl.items.length > tl.settings.visibleItems ? tl.items.length - tl.settings.visibleItems : 0;\n    } else {\n      currentIndex = tl.settings.startIndex;\n    }\n    tl.timelineEl.classList.add('timeline--horizontal');\n    setHeightandWidths(tl);\n    timelinePosition(tl);\n    addNavigation(tl);\n    addHorizontalDivider(tl);\n    slideTimeline(tl);\n\n    const timelineId = tl.timelineEl.id || tl.timelineEl.getAttribute('data-timeline-id');\n    if (timelineId) {\n      timelineRegistry[timelineId] = {\n        setCurrentIndex: function(index) {\n          const viewportWidth = tl.wrap.offsetWidth;\n          const itemsVisible = Math.floor(viewportWidth / tl.itemWidth);\n          const maxIndex = Math.max(0, tl.items.length - itemsVisible);\n          currentIndex = Math.max(0, Math.min(index, maxIndex));\n        },\n        updatePosition: function() {\n          timelinePosition(tl);\n          const arrowPrev = tl.timelineEl.querySelector('.timeline-nav-button--prev');\n          const arrowNext = tl.timelineEl.querySelector('.timeline-nav-button--next');\n          if (arrowPrev && arrowNext) {\n            const viewportWidth = tl.wrap.offsetWidth;\n            const itemsVisible = Math.floor(viewportWidth / tl.itemWidth);\n            const maxIndex = Math.max(0, tl.items.length - itemsVisible);\n            arrowPrev.disabled = currentIndex === 0;\n            arrowNext.disabled = currentIndex >= maxIndex;\n          }\n        }\n      };\n    }\n  }\n\n  function setUpVerticalTimeline(tl) {\n    let lastVisibleIndex = 0;\n    tl.items.forEach((item, i) => {\n      item.classList.remove('animated', 'fadeIn');\n      if (!isElementInViewport(item, tl.settings.verticalTrigger) && i > 0) {\n        item.classList.add('animated');\n      } else {\n        lastVisibleIndex = i;\n      }\n      const divider = tl.settings.verticalStartPosition === 'left' ? 1 : 0;\n      if (i % 2 === divider && window.innerWidth > tl.settings.minWidth) {\n        item.classList.add('timeline__item--right');\n      } else {\n        item.classList.add('timeline__item--left');\n      }\n    });\n    for (let i = 0; i < lastVisibleIndex; i += 1) {\n      tl.items[i].classList.remove('animated', 'fadeIn');\n    }\n    \n    // Use IntersectionObserver instead of scroll listener for better performance\n    if ('IntersectionObserver' in window) {\n      const observerOptions = {\n        rootMargin: tl.settings.verticalTrigger.unit === '%' \n          ? `${tl.settings.verticalTrigger.value}%` \n          : `${tl.settings.verticalTrigger.value}px`,\n        threshold: 0.01\n      };\n      \n      const observer = new IntersectionObserver((entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            entry.target.classList.add('fadeIn');\n          }\n        });\n      }, observerOptions);\n      \n      tl.items.forEach((item) => {\n        if (item.classList.contains('animated')) {\n          observer.observe(item);\n        }\n      });\n      \n      // Store observer for cleanup\n      tl.observer = observer;\n    } else {\n      // Fallback for older browsers (though we're targeting 2018+)\n      const scrollHandler = () => {\n        tl.items.forEach((item) => {\n          if (isElementInViewport(item, tl.settings.verticalTrigger)) {\n            item.classList.add('fadeIn');\n          }\n        });\n      };\n      window.addEventListener('scroll', scrollHandler);\n      tl.listeners.push({ element: window, type: 'scroll', handler: scrollHandler });\n    }\n  }\n\n  function resetTimelines(tl) {\n    // Clean up event listeners\n    if (tl.listeners && tl.listeners.length > 0) {\n      tl.listeners.forEach(({ element, type, handler }) => {\n        element.removeEventListener(type, handler);\n      });\n      tl.listeners = [];\n    }\n    \n    // Clean up IntersectionObserver\n    if (tl.observer) {\n      tl.observer.disconnect();\n      tl.observer = null;\n    }\n    \n    tl.timelineEl.classList.remove('timeline--horizontal', 'timeline--mobile');\n    tl.scroller.removeAttribute('style');\n    tl.items.forEach((item) => {\n      item.removeAttribute('style');\n      item.classList.remove('animated', 'fadeIn', 'timeline__item--left', 'timeline__item--right');\n    });\n    const navArrows = tl.timelineEl.querySelectorAll('.timeline-nav-button');\n    Array.from(navArrows).forEach((arrow) => {\n      arrow.parentNode.removeChild(arrow);\n    });\n  }\n\n  function setUpTimelines() {\n    timelines.forEach((tl) => {\n      tl.timelineEl.style.opacity = 0;\n      if (!tl.timelineEl.classList.contains('timeline--loaded')) {\n        wrapElements(tl.items);\n      }\n      resetTimelines(tl);\n      if (window.innerWidth <= tl.settings.minWidth) {\n        tl.timelineEl.classList.add('timeline--mobile');\n      }\n      \n      // Determine which mode to use based on settings and viewport width\n      let useHorizontalMode = false;\n      if (tl.settings.mode === 'horizontal' && window.innerWidth > tl.settings.minWidth) {\n        useHorizontalMode = true;\n      } else if (tl.settings.mode === 'vertical' && window.innerWidth > tl.settings.maxWidth) {\n        useHorizontalMode = true;\n      }\n      \n      if (useHorizontalMode) {\n        setUpHorinzontalTimeline(tl);\n      } else {\n        setUpVerticalTimeline(tl);\n      }\n      tl.timelineEl.classList.add('timeline--loaded');\n    });\n\n    setTimeout(() => {\n      timelines.forEach((tl) => {\n        tl.timelineEl.style.opacity = 1;\n      });\n    }, 500);\n\n    if (shouldHideLoader) {\n      hideTimelineLoader();\n      shouldHideLoader = false;\n    }\n  }\n\n  setUpTimelines();\n\n  window.addEventListener('resize', () => {\n    clearTimeout(resizeTimer);\n    resizeTimer = setTimeout(() => {\n      const newWinWidth = window.innerWidth;\n      if (newWinWidth !== winWidth) {\n        setUpTimelines();\n        winWidth = newWinWidth;\n      }\n    }, 250);\n  });\n}","import { timelineBasePath } from '../shared/config.js';\nimport { showTimelineLoader, hideTimelineLoader } from './loader-ui.js';\nimport { showTimelineError } from './error-ui.js';\nimport { applyTimelineColors } from './colors.js';\nimport { handleDeepLinking } from './deep-linking.js';\nimport { timeline } from '../core/timeline-engine.js';\n\nfunction createItemNode(item) {\n  const itemEl = document.createElement('div');\n  itemEl.className = 'timeline__item';\n\n  if (item.id) {\n    itemEl.setAttribute('data-node-id', item.id);\n  }\n\n  itemEl.setAttribute('data-modal-title', item.title || '');\n  itemEl.setAttribute('data-modal-content', item.content || '');\n  itemEl.setAttribute('data-modal-image', item.image || '');\n  if (item.html) {\n    itemEl.setAttribute('data-modal-html', item.html);\n  }\n\n  const content = document.createElement('div');\n  content.className = 'timeline__content';\n\n  if (item.image) {\n    const img = document.createElement('img');\n    img.src = item.image;\n    img.className = 'timeline__image';\n    img.alt = item.title || '';\n    img.onerror = function() {\n      console.error('Timeline: The image \"' + item.image + '\" could not be loaded. Please check the path.');\n      this.src = timelineBasePath + '/missing-image.svg';\n      this.alt = 'Image not found';\n      this.title = 'Original image: ' + item.image;\n    };\n    content.appendChild(img);\n  }\n\n  const textWrapper = document.createElement('div');\n  if (item.title) {\n    const title = document.createElement('h3');\n    title.textContent = item.title;\n    textWrapper.appendChild(title);\n  }\n\n  if (item.content) {\n    const para = document.createElement('p');\n    let displayText = item.content;\n    if (displayText.length > 105) {\n      displayText = displayText.substring(0, 105) + '...';\n    }\n    para.innerHTML = displayText;\n    textWrapper.appendChild(para);\n  }\n\n  if (item.html) {\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = item.html;\n    textWrapper.appendChild(wrapper);\n  }\n\n  content.appendChild(textWrapper);\n  itemEl.appendChild(content);\n\n  itemEl.addEventListener('click', function(e) {\n    e.preventDefault();\n    if (typeof window.openTimelineModal === 'function') {\n      window.openTimelineModal(itemEl);\n    }\n  });\n  itemEl.setAttribute('data-modal-bound', '1');\n\n  return itemEl;\n}\n\nfunction applyDataAttributes(container, config) {\n  if (config.layoutMode) {\n    container.setAttribute('data-mode', config.layoutMode);\n  }\n  if (config.visibleItems !== undefined) {\n    container.setAttribute('data-visible-items', config.visibleItems);\n  }\n  if (config.minWidth !== undefined) {\n    container.setAttribute('data-min-width', config.minWidth);\n    container.setAttribute('data-force-vertical-mode', config.minWidth);\n  }\n  if (config.maxWidth !== undefined) {\n    container.setAttribute('data-max-width', config.maxWidth);\n  }\n}\n\nexport function renderTimelineFromData(containerSelector, data, config) {\n  const container = document.querySelector(containerSelector);\n  if (!container) return;\n\n  let itemsWrap = container.querySelector('.timeline__items');\n  if (!itemsWrap) {\n    const wrap = document.createElement('div');\n    wrap.className = 'timeline__wrap';\n    itemsWrap = document.createElement('div');\n    itemsWrap.className = 'timeline__items';\n    wrap.appendChild(itemsWrap);\n    container.appendChild(wrap);\n  } else {\n    itemsWrap.innerHTML = '';\n  }\n\n  if (config) {\n    applyDataAttributes(container, config);\n    applyTimelineColors(container, config);\n\n    if (config.timelineName && config.timelineName.trim() !== '') {\n      const existingHeading = container.previousElementSibling;\n      if (existingHeading && existingHeading.classList.contains('timeline__heading')) {\n        existingHeading.textContent = config.timelineName;\n      } else {\n        const heading = document.createElement('h1');\n        heading.className = 'timeline__heading';\n        heading.textContent = config.timelineName;\n        container.parentNode.insertBefore(heading, container);\n      }\n      container.setAttribute('data-timeline-name', config.timelineName);\n    }\n  }\n\n  data.forEach(function (it) {\n    itemsWrap.appendChild(createItemNode(it));\n  });\n\n  return container;\n}\n\nexport function timelineFromData(containerSelector, data, options) {\n  const container = renderTimelineFromData(containerSelector, data, options);\n  if (!container) return;\n  timeline([container], options);\n}\n\nexport function loadDataFromJson(url, containerSelector) {\n  const container = document.querySelector(containerSelector);\n  if (!container) {\n    console.error('Timeline: Container not found:', containerSelector);\n    return;\n  }\n\n  showTimelineLoader();\n\n  const timelineId = container ? container.id : null;\n  const cacheKey = timelineId ? 'vjs_' + timelineId : null;\n\n  if (cacheKey && typeof(Storage) !== 'undefined') {\n    try {\n      const cached = localStorage.getItem(cacheKey);\n      if (cached) {\n        const cachedData = JSON.parse(cached);\n        fetch(url).then(function(res) {\n          if (!res.ok) throw new Error('Failed to load ' + url + ' (' + res.status + ')');\n          return res.json();\n        }).then(function(json) {\n          if (json.lastupdated && cachedData.lastupdated && json.lastupdated === cachedData.lastupdated) {\n            console.log('Using cached timeline data for', timelineId);\n            processTimelineData(cachedData, containerSelector);\n          } else {\n            console.log('Updating cached timeline data for', timelineId);\n            localStorage.setItem(cacheKey, JSON.stringify(json));\n            processTimelineData(json, containerSelector);\n          }\n        }).catch(function(err) {\n          console.warn('Failed to fetch fresh data, using cache:', err);\n          processTimelineData(cachedData, containerSelector);\n        });\n        return;\n      }\n    } catch (e) {\n      console.warn('Error reading from localStorage:', e);\n    }\n  }\n\n  fetch(url).then(function (res) {\n    if (!res.ok) throw new Error('Failed to load ' + url + ' (' + res.status + ')');\n    return res.json();\n  }).then(function (json) {\n    if (cacheKey && typeof(Storage) !== 'undefined') {\n      try {\n        localStorage.setItem(cacheKey, JSON.stringify(json));\n        console.log('Cached timeline data for', timelineId);\n      } catch (e) {\n        console.warn('Failed to cache timeline data:', e);\n      }\n    }\n    processTimelineData(json, containerSelector);\n  }).catch(function (err) {\n    console.error('Error loading timeline JSON:', err);\n    showTimelineError(container, 'json-load', err.message);\n  });\n}\n\nexport function processTimelineData(json, containerSelector) {\n  const container = document.querySelector(containerSelector);\n  if (!container) {\n    console.error('Timeline: Container not found:', containerSelector);\n    return;\n  }\n\n  let config = null;\n  let nodes = [];\n\n  try {\n    if (json.nodes && Array.isArray(json.nodes)) {\n      nodes = json.nodes;\n      config = {\n        timelineName: json.timelineName,\n        layoutMode: json.layoutMode,\n        visibleItems: json.visibleItems,\n        minWidth: json.minWidth,\n        maxWidth: json.maxWidth,\n        nodeColor: json.nodeColor,\n        lineColor: json.lineColor,\n        navColor: json.navColor,\n        lastupdated: json.lastupdated\n      };\n    } else if (Array.isArray(json)) {\n      nodes = json;\n    } else {\n      throw new Error('Invalid JSON format. Expected object with \"nodes\" array or simple array.');\n    }\n\n    if (nodes.length === 0) {\n      throw new Error('No timeline items found in data.');\n    }\n\n    renderTimelineFromData(containerSelector, nodes, config);\n\n    try {\n      timeline(document.querySelectorAll(containerSelector));\n      handleDeepLinking(containerSelector);\n      hideTimelineLoader();\n    } catch (e) {\n      console.error('Error initializing timeline:', e);\n      const container = document.querySelector(containerSelector);\n      if (container) {\n        showTimelineError(container, 'invalid-config', e.message);\n      }\n      hideTimelineLoader();\n    }\n\n  } catch (e) {\n    console.error('Error processing timeline data:', e);\n    showTimelineError(container, 'json-parse', e.message);\n    hideTimelineLoader();\n  }\n}\n\nexport function clearTimelineCache(timelineId) {\n  if (typeof(Storage) === 'undefined') {\n    console.warn('localStorage not supported');\n    return;\n  }\n\n  if (timelineId) {\n    const key = 'vjs_' + timelineId;\n    localStorage.removeItem(key);\n    console.log('Cleared cache for timeline:', timelineId);\n  } else {\n    const keys = Object.keys(localStorage);\n    let cleared = 0;\n    keys.forEach(function(key) {\n      if (key.startsWith('vjs_')) {\n        localStorage.removeItem(key);\n        cleared++;\n      }\n    });\n    console.log('Cleared', cleared, 'timeline cache(s)');\n  }\n}\n","// --------------------------------------------------------------------------\r\n// timeline.js - a vanilla JS app to display timelines\r\n// \r\n// Created in 2018 by Mike Collins (https://github.com/squarechip/timeline)\r\n// Modified in 2026 by Ken Dawson (https://github.com/kendawson-online)\r\n// Last updated: 01/08/26\r\n//\r\n// --------------------------------------------------------------------------\r\n\r\nimport { createTimelineModal, openTimelineModal, closeTimelineModal } from './features/modals.js';\r\nimport { handleDeepLinking, navigateToNodeIndex } from './features/deep-linking.js';\r\nimport { renderTimelineFromData, timelineFromData, loadDataFromJson, processTimelineData, clearTimelineCache } from './features/data-loader.js';\r\nimport { timeline } from './core/timeline-engine.js';\r\nimport '../css/timeline.css';\r\n\r\nfunction autoInitJsonTimelines() {\r\n  const timelinesWithJson = document.querySelectorAll('[data-json-config]');\r\n  timelinesWithJson.forEach(function(timelineEl) {\r\n    const jsonUrl = timelineEl.getAttribute('data-json-config');\r\n    if (!jsonUrl) return;\r\n    const className = (timelineEl.className || '').split(' ')[0];\r\n    const selector = timelineEl.id ? '#' + timelineEl.id : (className ? '.' + className : null);\r\n    if (selector) {\r\n      loadDataFromJson(jsonUrl, selector);\r\n    }\r\n  });\r\n}\r\n\r\nfunction exposeGlobals() {\r\n  if (typeof window === 'undefined') return;\r\n  window.timeline = timeline;\r\n  window.timelineFromData = timelineFromData;\r\n  window.renderTimelineFromData = renderTimelineFromData;\r\n  window.processTimelineData = processTimelineData;\r\n  window.loadDataFromJson = loadDataFromJson;\r\n  window.clearTimelineCache = clearTimelineCache;\r\n  window.createTimelineModal = createTimelineModal;\r\n  window.openTimelineModal = openTimelineModal;\r\n  window.closeTimelineModal = closeTimelineModal;\r\n  window.handleTimelineDeepLinking = handleDeepLinking;\r\n  window.navigateTimelineToNodeIndex = navigateToNodeIndex;\r\n}\r\n\r\nexposeGlobals();\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  autoInitJsonTimelines();\r\n});\r\n\r\nif (typeof window !== 'undefined' && window.jQuery) {\r\n  (( $) => {\r\n    $.fn.timeline = function(opts) {\r\n      timeline(this, opts);\r\n      return this;\r\n    };\r\n  })(window.jQuery);\r\n}\r\n\r\nexport {\r\n  timeline,\r\n  timelineFromData,\r\n  renderTimelineFromData,\r\n  loadDataFromJson,\r\n  processTimelineData,\r\n  clearTimelineCache,\r\n  createTimelineModal,\r\n  openTimelineModal,\r\n  closeTimelineModal,\r\n  handleDeepLinking,\r\n  navigateToNodeIndex\r\n};"],"names":["loaderState","count","startTime","removeTimer","overlayEl","modalState","modal","overlay","timelineRegistry","createTimelineModal","document","createElement","className","addEventListener","closeTimelineModal","innerHTML","closeBtn","querySelector","closeBottomBtn","e","stopPropagation","body","appendChild","key","classList","contains","openTimelineModal","itemEl","title","getAttribute","content","image","html","modalTitle","modalText","modalImage","textContent","src","alt","style","display","replace","setTimeout","add","overflow","remove","handleDeepLinking","containerSelector","urlParams","URLSearchParams","window","location","search","timelineId","get","nodeId","targetContainer","getElementById","console","warn","scrollIntoView","behavior","block","targetNode","itemIndex","Array","from","parentNode","children","indexOf","navigateToNodeIndex","container","index","id","tlData","setCurrentIndex","updatePosition","timelineBasePath","TimelineConfig","basePath","scripts","getElementsByTagName","i","length","dir","substring","lastIndexOf","showTimelineLoader","Date","now","clearTimeout","loader","spinner","width","height","hideTimelineLoader","elapsed","remaining","Math","max","removeOverlay","showTimelineError","errorType","details","errorInfo","message","solution","errorDiv","errorIcon","errorTitle","errorMessage","errorSolution","errorDetails","error","getColorBrightness","color","rgb","startsWith","hex","parseInt","matches","match","map","Number","applyTimelineColors","config","nodeColor","lineColor","navColor","setProperty","arrowColor","setAttribute","createArrowSVG","direction","timeline","collection","options","timelines","warningLabel","resizeTimer","winWidth","innerWidth","currentIndex","shouldHideLoader","defaultSettings","minWidth","type","defaultValue","maxWidth","horizontalStartPosition","acceptedValues","mode","moveItems","rtlMode","startIndex","verticalStartPosition","verticalTrigger","visibleItems","itemWrap","el","wrapper","classes","insertBefore","isElementInViewport","triggerPosition","rect","getBoundingClientRect","windowHeight","innerHeight","documentElement","clientHeight","defaultTrigger","triggerUnit","unit","triggerValue","value","trigger","top","left","clientWidth","addTransforms","transform","webkitTransform","msTransform","timelinePosition","tl","str","items","offsetLeft","scroller","setUpHorinzontalTimeline","settings","timelineEl","itemWidth","forEach","item","scrollerWidth","oddIndexTallest","evenIndexTallest","offsetHeight","transformString","setHeights","setHeightandWidths","viewportWidth","wrap","offsetWidth","itemsVisible","floor","prevArrow","nextArrow","topPosition","maxIndex","disabled","addNavigation","divider","removeChild","horizontalDivider","addHorizontalDivider","navArrows","querySelectorAll","arrowPrev","arrowNext","handleArrowClick","preventDefault","this","arrow","listeners","push","element","handler","slideTimeline","min","setUpTimelines","opacity","removeEventListener","observer","disconnect","removeAttribute","resetTimelines","useHorizontalMode","lastVisibleIndex","observerOptions","rootMargin","threshold","IntersectionObserver","entries","entry","isIntersecting","target","observe","scrollHandler","setUpVerticalTimeline","timelineName","errorPart","data","dataset","Error","slice","call","Object","keys","candidate","undefined","minwidth","forceVerticalMode","forceverticalmode","maxwidth","settingName","getData","k","toLowerCase","triggerArray","triggerValid","hasAttribute","heading","trim","firstP","img","ensureInlineModalData","enhanceInlineItems","random","toString","substr","newWinWidth","renderTimelineFromData","itemsWrap","layoutMode","applyDataAttributes","existingHeading","previousElementSibling","it","onerror","textWrapper","para","displayText","createItemNode","timelineFromData","loadDataFromJson","url","cacheKey","cached","localStorage","getItem","cachedData","JSON","parse","fetch","then","res","ok","status","json","lastupdated","log","processTimelineData","setItem","stringify","catch","err","nodes","isArray","clearTimelineCache","removeItem","cleared","handleTimelineDeepLinking","navigateTimelineToNodeIndex","jsonUrl","split","selector","jQuery","fn","opts"],"mappings":"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"}